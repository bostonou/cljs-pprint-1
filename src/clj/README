This is the original clojure.pprint implementation, duplicated here only for reference.
